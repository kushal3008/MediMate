<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Doctor Dashboard - Mediconnect</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        body {
            background: var(--color-5);
            min-height: 100vh;
            margin: 0;
            display: flex;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        .sidebar {
            width: 260px;
            background: var(--color-5);
            color: var(--color-5);
            min-height: 100vh;
            box-shadow: 2px 0 16px rgba(0,0,0,0.07);
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            padding-top: 40px;
            position: fixed;
            left: 0;
            top: 0;
            z-index: 10;
        }
        .sidebar h2 {
            font-size: 1.6rem;
            font-weight: bold;
            color: var(--color-4);
            margin: 0 0 32px 32px;
            letter-spacing: 1px;
        }
        .sidebar nav {
            width: 100%;
        }
        .sidebar nav a {
            display: block;
            padding: 16px 32px;
            color: var(--color-1);
            text-decoration: none;
            font-size: 1.1rem;
            font-weight: 500;
            border-left: 4px solid transparent;
            transition: background 0.2s, border-color 0.2s, color 0.2s;
        }
        .sidebar nav a.active, .sidebar nav a:hover {
            background: var(--color-1);
            color: var(--color-4);
            border-left: 4px solid var(--color-4);
        }
        .sidebar nav a i {
            width: 20px;
            text-align: center;
        }
        .main-content {
            margin-left: 260px;
            padding: 40px 32px;
            width: 100%;
            min-height: 100vh;
            background: rgba(255,255,255,0.97);
        }
        .section {
            display: none;
        }
        .section.active {
            display: block;
        }

        /* Dashboard Styles */
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-bottom: 20px;
        }

        .dashboard-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .dashboard-card h3 {
            color: var(--color-5);
            margin-bottom: 15px;
            font-size: 1.2rem;
        }

        .chart-container {
            position: relative;
            height: 300px;
            width: 100%;
        }

        /* Patient List Styles */
        .patient-list {
            max-height: 600px;
            overflow-y: auto;
        }

        .patient-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 15px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
            border: 1px solid var(--color-3);
        }

        .patient-card h4 {
            margin: 0 0 10px 0;
            color: var(--color-5);
        }

        .patient-info {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-bottom: 15px;
        }

        .patient-info p {
            margin: 0;
            color: black;
        }

        .patient-info strong {
            color: var(--color-5);
        }

        .prescription-form {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid var(--color-3);
        }

        .prescription-form textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid var(--color-3);
            border-radius: 5px;
            margin-bottom: 10px;
            resize: vertical;
            min-height: 100px;
        }

        .btn {
            background-color: var(--color-5);
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1em;
            transition: background-color 0.3s ease;
        }

        .btn:hover {
            background-color: var(--color-4);
        }

        /* Appointment Styles */
        .appointment-list {
            display: grid;
            gap: 20px;
            margin-top: 20px;
        }

        .appointment-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .appointment-info h3 {
            margin: 0 0 10px 0;
            color: var(--color-5);
        }

        .appointment-info p {
            margin: 5px 0;
            color: var(--color-4);
        }

        .appointment-actions {
            display: flex;
            gap: 10px;
        }

        .btn-outline {
            background: transparent;
            border: 2px solid var(--color-5);
            color: var(--color-5);
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-outline:hover {
            background: var(--color-5);
            color: white;
        }

        .rating {
            color: #FFC107;
            margin: 5px 0;
        }

        .rating span {
            margin-right: 2px;
        }

        .open-status {
            display: inline-block;
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 0.8rem;
            margin-left: 10px;
        }

        .status-open {
            background: #e8f5e9;
            color: #2e7d32;
        }

        .status-closed {
            background: #ffebee;
            color: #c62828;
        }

        /* Add modal styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 10px;
            width: 90%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
        }

        .modal-close {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 24px;
            cursor: pointer;
            color: var(--color-5);
        }

        .medicine-order-form {
            margin-top: 20px;
        }

        .medicine-item {
            display: grid;
            grid-template-columns: 2fr 1fr 1fr auto;
            gap: 10px;
            align-items: center;
            padding: 10px;
            border-bottom: 1px solid var(--color-3);
        }

        .medicine-item:last-child {
            border-bottom: none;
        }

        .add-medicine-btn {
            background: var(--color-5);
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 10px;
        }

        .remove-medicine-btn {
            background: #ff4444;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 3px;
            cursor: pointer;
        }

        .order-summary {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 2px solid var(--color-3);
        }

        .total-amount {
            font-size: 1.2em;
            font-weight: bold;
            color: var(--color-5);
            text-align: right;
            margin: 15px 0;
        }

        .order-notes {
            width: 100%;
            padding: 10px;
            border: 1px solid var(--color-3);
            border-radius: 5px;
            margin-top: 10px;
            resize: vertical;
            min-height: 80px;
        }

        .medicine-search {
            width: 100%;
            padding: 10px;
            border: 1px solid var(--color-3);
            border-radius: 5px;
            margin-bottom: 15px;
        }

        .medicine-suggestions {
            max-height: 200px;
            overflow-y: auto;
            border: 1px solid var(--color-3);
            border-radius: 5px;
            display: none;
        }

        .medicine-suggestion-item {
            padding: 10px;
            cursor: pointer;
            border-bottom: 1px solid var(--color-3);
        }

        .medicine-suggestion-item:hover {
            background: #f5f5f5;
        }

        .medicine-suggestion-item:last-child {
            border-bottom: none;
        }

        /* Add these styles to the existing styles section */
        .prescription-form {
            margin-top: 20px;
        }

        .prescription-form .form-group {
            margin-bottom: 20px;
        }

        .prescription-form label {
            display: block;
            margin-bottom: 5px;
            color: var(--color-5);
            font-weight: 500;
        }

        .prescription-form input,
        .prescription-form textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid var(--color-3);
            border-radius: 5px;
            font-size: 1em;
        }

        .prescription-form textarea {
            min-height: 100px;
            resize: vertical;
        }

        .prescription-medicine-item {
            display: grid;
            grid-template-columns: 2fr 1fr 1fr auto;
            gap: 10px;
            align-items: center;
            padding: 10px;
            border: 1px solid var(--color-3);
            border-radius: 5px;
            margin-bottom: 10px;
        }

        .prescription-medicine-item select,
        .prescription-medicine-item input {
            padding: 8px;
            border: 1px solid var(--color-3);
            border-radius: 4px;
        }

        .prescription-medicine-item .remove-btn {
            background: #ff4444;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 3px;
            cursor: pointer;
        }

        @media (max-width: 768px) {
            .sidebar {
                width: 70px;
                padding-top: 20px;
            }
            .sidebar h2 {
                display: none;
            }
            .sidebar nav a {
                padding: 14px 10px;
                font-size: 0.95rem;
                text-align: center;
            }
            .main-content {
                margin-left: 70px;
                padding: 24px 8px;
            }
            .dashboard-grid {
                grid-template-columns: 1fr;
            }
            .patient-info {
                grid-template-columns: 1fr;
            }
        }

        /* Add these styles to the existing styles section */
        .chemist-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            transition: transform 0.2s;
        }

        .chemist-card:hover {
            transform: translateY(-5px);
        }

        .chemist-card h3 {
            color: var(--color-5);
            margin: 0 0 10px 0;
            font-size: 1.2rem;
        }

        .chemist-info {
            margin-bottom: 15px;
        }

        .chemist-info p {
            margin: 5px 0;
            color: black;
        }

        .chemist-info strong {
            color: var(--color-5);
        }

        .chemist-distance {
            display: inline-block;
            padding: 5px 10px;
            background: #e3f2fd;
            color: #1976d2;
            border-radius: 15px;
            font-size: 0.9rem;
            margin-top: 10px;
        }

        .chemist-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        .chemist-actions .btn {
            flex: 1;
            text-align: center;
        }

        .rating {
            color: #FFC107;
            margin: 5px 0;
        }

        .rating span {
            margin-right: 2px;
        }

        .open-status {
            display: inline-block;
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 0.8rem;
            margin-left: 10px;
        }

        .status-open {
            background: #e8f5e9;
            color: #2e7d32;
        }

        .status-closed {
            background: #ffebee;
            color: #c62828;
        }

        /* Add these styles to the existing styles section */
        .profile-form {
            max-width: 500px;
            margin: 20px auto;
            padding: 20px;
        }

        .profile-form .form-group {
            margin-bottom: 15px;
        }

        .profile-form input,
        .profile-form textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid var(--color-3);
            border-radius: 5px;
        }

        .profile-form textarea {
            min-height: 100px;
            resize: vertical;
        }
    </style>
</head>
<body>
    <aside class="sidebar">
        <h2>Doctor</h2>
        <nav>
            <a href="#dashboard" class="active" onclick="showSection(event, 'dashboard')">Dashboard</a>
            <a href="#patients" onclick="showSection(event, 'patients')">Patients</a>
            <a href="#appointments" onclick="showSection(event, 'appointments')">Appointments</a>
            <a href="#nearby-chemists" onclick="showSection(event, 'nearby-chemists')">Nearby Chemists</a>
            <a href="#profile" onclick="showSection(event, 'profile')">Profile</a>
        </nav>
    </aside>
    <main class="main-content">
        <!-- Dashboard Section -->
        <section id="dashboard" class="section active">
            <h2>Dashboard</h2>
            <div class="dashboard-grid">
                <div class="dashboard-card">
                    <h3>Today's Appointments</h3>
                    <div class="chart-container">
                        <canvas id="appointmentsChart"></canvas>
                    </div>
                </div>
                <div class="dashboard-card">
                    <h3>Patient Statistics</h3>
                    <div class="chart-container">
                        <canvas id="patientsChart"></canvas>
                    </div>
                </div>
                <div class="dashboard-card">
                    <h3>Recent Prescriptions</h3>
                    <div id="recent-prescriptions" class="patient-list">
                        <!-- Will be populated by JavaScript -->
                    </div>
                </div>
                <div class="dashboard-card">
                    <h3>Upcoming Appointments</h3>
                    <div id="upcoming-appointments" class="appointment-list">
                        <!-- Will be populated by JavaScript -->
                    </div>
                </div>
            </div>
        </section>

        <!-- Patients Section -->
        <section id="patients" class="section">
            <h2>Patient Management</h2>
            <div class="search-bar">
                <input type="text" id="patientSearch" placeholder="Search patients...">
                <button class="btn" onclick="addNewPatient()">Add New Patient</button>
            </div>
            <div class="patient-list" id="patientsList">
                <!-- Patient cards will be populated here -->
            </div>
        </section>

        <!-- Appointments Section -->
        <section id="appointments" class="section">
            <h2>Appointment Management</h2>
            <div class="appointment-list">
                <!-- Appointment cards -->
            </div>
        </section>

        <!-- Nearby Chemists Section -->
        <section id="nearby-chemists" class="section">
            <h2>Nearby Registered Chemists</h2>
            <div class="search-box" style="margin-bottom: 20px;">
                <input type="text" id="chemist-search" placeholder="Search chemists by name or location..." 
                       style="width: 100%; padding: 10px; border: 1px solid var(--color-3); border-radius: 5px;">
            </div>
            <div class="chemists-grid" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px;">
                <!-- Will be populated by JavaScript -->
            </div>
        </section>

        <!-- Profile Section -->
        <section id="profile" class="section">
            <h2>Doctor Profile</h2>
            <form id="profile-form" class="profile-form">
                <div class="form-group">
                    <input type="text" id="doctor-name" placeholder="Full Name" required>
                </div>
                <div class="form-group">
                    <input type="text" id="specialization" placeholder="Specialization" required>
                </div>
                <div class="form-group">
                    <input type="email" id="email" placeholder="Email Address" required>
                </div>
                <div class="form-group">
                    <input type="tel" id="phone" placeholder="Phone Number" required>
                </div>
                <div class="form-group">
                    <textarea id="address" placeholder="Clinic Address" required></textarea>
                </div>
                <button type="submit" class="btn">Update Profile</button>
            </form>
        </section>
    </main>

    <!-- Add Prescription Modal -->
    <div id="prescriptionModal" class="modal">
        <div class="modal-content">
            <span class="modal-close" onclick="closePrescriptionModal()">&times;</span>
            <h2>Send Prescription</h2>
            <div id="prescriptionChemistInfo"></div>
            
            <div class="prescription-form">
                <div class="form-group">
                    <label for="patientName">Patient Name</label>
                    <input type="text" id="patientName" placeholder="Enter patient name" required>
                </div>
                <div class="form-group">
                    <label for="patientAge">Patient Age</label>
                    <input type="number" id="patientAge" placeholder="Enter patient age" required>
                </div>
                <div class="form-group">
                    <label for="diagnosis">Diagnosis</label>
                    <textarea id="diagnosis" placeholder="Enter diagnosis" required></textarea>
                </div>
                <div class="form-group">
                    <label for="prescriptionMedicines">Medicines</label>
                    <div id="prescriptionMedicineList">
                        <!-- Medicine items will be added here -->
                    </div>
                    <button class="add-medicine-btn" onclick="addPrescriptionMedicine()">Add Medicine</button>
                </div>
                <div class="form-group">
                    <label for="prescriptionNotes">Additional Notes</label>
                    <textarea id="prescriptionNotes" placeholder="Add any additional notes or instructions..."></textarea>
                </div>
                <button class="btn" onclick="sendPrescription()">Send Prescription</button>
            </div>
        </div>
    </div>

    <!-- Keep the existing Order Medicine Modal -->
    <div id="orderMedicineModal" class="modal">
        <div class="modal-content">
            <span class="modal-close" onclick="closeOrderModal()">&times;</span>
            <h2>Order Medicines</h2>
            <div id="selectedChemistInfo"></div>
            
            <div class="medicine-order-form">
                <input type="text" 
                       class="medicine-search" 
                       placeholder="Search medicines..." 
                       oninput="searchMedicines(this.value)"
                       id="medicineSearchInput">
                <div class="medicine-suggestions" id="medicineSuggestions"></div>
                
                <div id="medicineOrderList">
                    <!-- Medicine items will be added here -->
                </div>
                
                <button class="add-medicine-btn" onclick="addMedicineItem()">Add Medicine</button>
                
                <div class="order-summary">
                    <textarea class="order-notes" 
                              placeholder="Add any special instructions or notes for the chemist..."
                              id="orderNotes"></textarea>
                    <div class="total-amount">Total: ₹<span id="orderTotal">0.00</span></div>
                    <button class="btn" onclick="placeOrder()">Place Order</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        // Dashboard functionality
        function initializeDashboard() {
            // Initialize appointments chart
            const appointmentsCtx = document.getElementById('appointmentsChart').getContext('2d');
            new Chart(appointmentsCtx, {
                type: 'bar',
                data: {
                    labels: ['9 AM', '10 AM', '11 AM', '12 PM', '2 PM', '3 PM', '4 PM'],
                    datasets: [{
                        label: 'Appointments',
                        data: [2, 3, 1, 0, 2, 4, 1],
                        backgroundColor: '#2196F3',
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                stepSize: 1
                            }
                        }
                    }
                }
            });

            // Initialize patients chart
            const patientsCtx = document.getElementById('patientsChart').getContext('2d');
            new Chart(patientsCtx, {
                type: 'doughnut',
                data: {
                    labels: ['New Patients', 'Follow-up', 'Regular'],
                    datasets: [{
                        data: [30, 45, 25],
                        backgroundColor: ['#4CAF50', '#2196F3', '#FFC107']
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });

            // Load sample data
            loadRecentPrescriptions();
            loadUpcomingAppointments();
        }

        function loadRecentPrescriptions() {
            const prescriptions = [
                {
                    patient: 'Rahul Kumar',
                    date: '2024-03-15',
                    medicines: ['Paracetamol 500mg', 'Amoxicillin 250mg'],
                    diagnosis: 'Fever and sore throat'
                },
                {
                    patient: 'Priya Singh',
                    date: '2024-03-14',
                    medicines: ['Ibuprofen 400mg', 'Omeprazole 20mg'],
                    diagnosis: 'Gastritis'
                }
            ];

            const prescriptionsList = document.getElementById('recent-prescriptions');
            prescriptionsList.innerHTML = prescriptions.map(prescription => `
                <div class="patient-card">
                    <h4>${prescription.patient}</h4>
                    <p><strong>Date:</strong> ${prescription.date}</p>
                    <p><strong>Diagnosis:</strong> ${prescription.diagnosis}</p>
                    <p><strong>Medicines:</strong> ${prescription.medicines.join(', ')}</p>
                </div>
            `).join('');
        }

        function loadUpcomingAppointments() {
            const appointments = [
                {
                    patient: 'Amit Patel',
                    time: '10:00 AM',
                    type: 'Follow-up',
                    status: 'scheduled'
                },
                {
                    patient: 'Neha Sharma',
                    time: '11:30 AM',
                    type: 'New Patient',
                    status: 'scheduled'
                }
            ];

            const appointmentsList = document.getElementById('upcoming-appointments');
            appointmentsList.innerHTML = appointments.map(appointment => `
                <div class="appointment-card">
                    <div class="appointment-info">
                        <h4>${appointment.patient}</h4>
                        <p>Time: ${appointment.time}</p>
                        <p>Type: ${appointment.type}</p>
                    </div>
                    <span class="appointment-status status-${appointment.status}">
                        ${appointment.status.charAt(0).toUpperCase() + appointment.status.slice(1)}
                    </span>
                </div>
            `).join('');
        }

        function loadPatients() {
            const patients = [
                {
                    name: 'Rahul Kumar',
                    age: 35,
                    gender: 'Male',
                    phone: '+91 9876543210',
                    lastVisit: '2024-03-15',
                    medicalHistory: 'Hypertension, Type 2 Diabetes'
                },
                {
                    name: 'Priya Singh',
                    age: 28,
                    gender: 'Female',
                    phone: '+91 9876543211',
                    lastVisit: '2024-03-14',
                    medicalHistory: 'Asthma'
                }
            ];

            const patientsList = document.getElementById('patientsList');
            patientsList.innerHTML = patients.map(patient => `
                <div class="patient-card">
                    <h4>${patient.name}</h4>
                    <div class="patient-info">
                        <p><strong>Age:</strong> ${patient.age}</p>
                        <p><strong>Gender:</strong> ${patient.gender}</p>
                        <p><strong>Phone:</strong> ${patient.phone}</p>
                        <p><strong>Last Visit:</strong> ${patient.lastVisit}</p>
                    </div>
                    <p><strong>Medical History:</strong> ${patient.medicalHistory}</p>
                    <div class="prescription-form">
                        <textarea placeholder="Write prescription..."></textarea>
                        <button class="btn" onclick="sendPrescription('${patient.name}')">Send Prescription</button>
                    </div>
                </div>
            `).join('');
        }

        function loadAppointments() {
            const appointments = [
                {
                    patient: 'Amit Patel',
                    date: '2024-03-16',
                    time: '10:00 AM',
                    type: 'Follow-up',
                    status: 'scheduled'
                },
                {
                    patient: 'Neha Sharma',
                    date: '2024-03-16',
                    time: '11:30 AM',
                    type: 'New Patient',
                    status: 'scheduled'
                },
                {
                    patient: 'Rajesh Kumar',
                    date: '2024-03-15',
                    time: '2:00 PM',
                    type: 'Regular Checkup',
                    status: 'completed'
                }
            ];

            const appointmentsList = document.getElementById('appointments-list');
            appointmentsList.innerHTML = appointments.map(appointment => `
                <div class="appointment-card">
                    <div class="appointment-info">
                        <h4>${appointment.patient}</h4>
                        <p>Date: ${appointment.date}</p>
                        <p>Time: ${appointment.time}</p>
                        <p>Type: ${appointment.type}</p>
                    </div>
                    <span class="appointment-status status-${appointment.status}">
                        ${appointment.status.charAt(0).toUpperCase() + appointment.status.slice(1)}
                    </span>
                </div>
            `).join('');
        }

        function showSection(event, sectionId) {
            event.preventDefault();
            document.querySelectorAll('.section').forEach(section => {
                section.classList.remove('active');
            });
            document.getElementById(sectionId).classList.add('active');
            
            document.querySelectorAll('.sidebar a').forEach(link => {
                link.classList.remove('active');
            });
            event.target.classList.add('active');

            // Load section-specific data
            if (sectionId === 'dashboard') {
                initializeDashboard();
            } else if (sectionId === 'patients') {
                loadPatients();
            } else if (sectionId === 'appointments') {
                loadAppointments();
            } else if (sectionId === 'nearby-chemists') {
                loadNearbyChemists();
            }
        }

        // Initialize dashboard when the page loads
        document.addEventListener('DOMContentLoaded', function() {
            initializeDashboard();
        });

        // Add logout function
        function logout() {
            // Add logout logic here
            window.location.href = 'index.html';
        }

        // Handle profile form submission
        document.getElementById('profile-form').addEventListener('submit', function(e) {
            e.preventDefault();
            // Add profile update logic here
            alert('Profile updated successfully!');
        });

        function sendPrescription(patientName) {
            // Add prescription sending logic here
            alert(`Prescription sent to ${patientName}`);
        }

        function loadNearbyChemists() {
            // Sample data - replace with actual API call
            const chemists = [
                {
                    id: 1,
                    name: "MedPlus Pharmacy",
                    owner: "Rajesh Kumar",
                    address: "123 Main Street, Sector 15",
                    phone: "+91 9876543210",
                    distance: "0.5 km",
                    rating: 4.5,
                    isOpen: true,
                    timings: "9:00 AM - 9:00 PM",
                    license: "PH123456"
                },
                {
                    id: 2,
                    name: "HealthCare Pharmacy",
                    owner: "Priya Singh",
                    address: "456 Park Road, Sector 22",
                    phone: "+91 9876543211",
                    distance: "1.2 km",
                    rating: 4.2,
                    isOpen: true,
                    timings: "8:00 AM - 10:00 PM",
                    license: "PH789012"
                },
                {
                    id: 3,
                    name: "City Medical Store",
                    owner: "Amit Patel",
                    address: "789 Market Street, Sector 8",
                    phone: "+91 9876543212",
                    distance: "2.0 km",
                    rating: 4.0,
                    isOpen: false,
                    timings: "10:00 AM - 8:00 PM",
                    license: "PH345678"
                }
            ];

            const chemistsGrid = document.querySelector('.chemists-grid');
            chemistsGrid.innerHTML = chemists.map(chemist => `
                <div class="chemist-card">
                    <div class="chemist-info">
                        <h3>${chemist.name}</h3>
                        <p><strong>Address:</strong> ${chemist.address}</p>
                        <p><strong>Phone:</strong> ${chemist.phone}</p>
                        <p><strong>Distance:</strong> ${chemist.distance} km</p>
                    </div>
                    <div class="chemist-actions">
                        <button class="btn" onclick="viewChemistDetails('${chemist.id}')">Order Medicine</button>
                    </div>
                </div>
            `).join('');

            // Add search functionality
            const searchInput = document.getElementById('chemist-search');
            searchInput.addEventListener('input', function(e) {
                const searchTerm = e.target.value.toLowerCase();
                const filteredChemists = chemists.filter(chemist => 
                    chemist.name.toLowerCase().includes(searchTerm) ||
                    chemist.address.toLowerCase().includes(searchTerm) ||
                    chemist.owner.toLowerCase().includes(searchTerm)
                );
                
                chemistsGrid.innerHTML = filteredChemists.map(chemist => `
                    <div class="chemist-card">
                        <div class="chemist-info">
                            <h3>${chemist.name}</h3>
                            <p><strong>Address:</strong> ${chemist.address}</p>
                            <p><strong>Phone:</strong> ${chemist.phone}</p>
                            <p><strong>Distance:</strong> ${chemist.distance} km</p>
                        </div>
                        <div class="chemist-actions">
                            <button class="btn" onclick="viewChemistDetails('${chemist.id}')">Order Medicine</button>
                        </div>
                    </div>
                `).join('');
            });
        }

        // Add medicine ordering functionality
        let currentChemistId = null;
        let selectedMedicines = [];
        const medicinePrices = {
            'Paracetamol 500mg': 5.00,
            'Amoxicillin 250mg': 8.50,
            'Ibuprofen 400mg': 7.25,
            'Omeprazole 20mg': 12.00,
            'Cetirizine 10mg': 4.75,
            'Aspirin 75mg': 3.50,
            'Metformin 500mg': 6.25,
            'Atorvastatin 20mg': 15.00,
            'Losartan 50mg': 9.75,
            'Metoprolol 25mg': 8.00
        };

        function viewChemistDetails(chemistId) {
            currentChemistId = chemistId;
            const chemist = getChemistDetails(chemistId);
            const modal = document.getElementById('orderMedicineModal');
            const chemistInfo = document.getElementById('selectedChemistInfo');
            
            chemistInfo.innerHTML = `
                <h3>${chemist.name}</h3>
                <p><strong>Address:</strong> ${chemist.address}</p>
                <p><strong>Phone:</strong> ${chemist.phone}</p>
            `;
            
            modal.classList.add('active');
            resetOrderForm();
        }

        function closeOrderModal() {
            document.getElementById('orderMedicineModal').classList.remove('active');
            resetOrderForm();
        }

        function resetOrderForm() {
            selectedMedicines = [];
            document.getElementById('medicineOrderList').innerHTML = '';
            document.getElementById('orderNotes').value = '';
            document.getElementById('orderTotal').textContent = '0.00';
            document.getElementById('medicineSearchInput').value = '';
            document.getElementById('medicineSuggestions').style.display = 'none';
        }

        function searchMedicines(query) {
            const suggestions = document.getElementById('medicineSuggestions');
            if (!query) {
                suggestions.style.display = 'none';
                return;
            }

            const filteredMedicines = Object.keys(medicinePrices).filter(medicine => 
                medicine.toLowerCase().includes(query.toLowerCase())
            );

            if (filteredMedicines.length > 0) {
                suggestions.innerHTML = filteredMedicines.map(medicine => `
                    <div class="medicine-suggestion-item" onclick="selectMedicine('${medicine}')">
                        ${medicine} - ₹${medicinePrices[medicine].toFixed(2)}
                    </div>
                `).join('');
                suggestions.style.display = 'block';
            } else {
                suggestions.style.display = 'none';
            }
        }

        function selectMedicine(medicine) {
            document.getElementById('medicineSearchInput').value = medicine;
            document.getElementById('medicineSuggestions').style.display = 'none';
            addMedicineItem(medicine);
        }

        function addMedicineItem(medicineName = '') {
            const medicineList = document.getElementById('medicineOrderList');
            const medicineId = Date.now(); // Unique ID for the medicine item
            
            const medicineItem = document.createElement('div');
            medicineItem.className = 'medicine-item';
            medicineItem.setAttribute('data-id', medicineId);
            medicineItem.innerHTML = `
                <select onchange="updateMedicinePrice(${medicineId})" class="medicine-select">
                    <option value="">Select Medicine</option>
                    ${Object.keys(medicinePrices).map(med => 
                        `<option value="${med}" ${med === medicineName ? 'selected' : ''}>${med}</option>`
                    ).join('')}
                </select>
                <input type="number" 
                       value="1" 
                       min="1" 
                       onchange="updateMedicineQuantity(${medicineId})"
                       class="medicine-quantity">
                <span class="medicine-price">₹0.00</span>
                <button class="remove-medicine-btn" onclick="removeMedicineItem(${medicineId})">Remove</button>
            `;
            
            medicineList.appendChild(medicineItem);
            selectedMedicines.push({
                id: medicineId,
                name: medicineName || '',
                quantity: 1,
                price: medicineName ? medicinePrices[medicineName] : 0
            });
            
            updateOrderTotal();
        }

        function updateMedicinePrice(medicineId) {
            const medicineItem = document.querySelector(`[data-id="${medicineId}"]`);
            const select = medicineItem.querySelector('.medicine-select');
            const medicine = select.value;
            const price = medicinePrices[medicine] || 0;
            
            const medicineIndex = selectedMedicines.findIndex(m => m.id === medicineId);
            if (medicineIndex !== -1) {
                selectedMedicines[medicineIndex].name = medicine;
                selectedMedicines[medicineIndex].price = price;
                updateOrderTotal();
            }
        }

        function updateMedicineQuantity(medicineId) {
            const medicineItem = document.querySelector(`[data-id="${medicineId}"]`);
            const quantity = parseInt(medicineItem.querySelector('.medicine-quantity').value) || 0;
            
            const medicineIndex = selectedMedicines.findIndex(m => m.id === medicineId);
            if (medicineIndex !== -1) {
                selectedMedicines[medicineIndex].quantity = quantity;
                updateOrderTotal();
            }
        }

        function removeMedicineItem(medicineId) {
            const medicineItem = document.querySelector(`[data-id="${medicineId}"]`);
            medicineItem.remove();
            selectedMedicines = selectedMedicines.filter(m => m.id !== medicineId);
            updateOrderTotal();
        }

        function updateOrderTotal() {
            const total = selectedMedicines.reduce((sum, medicine) => 
                sum + (medicine.price * medicine.quantity), 0
            );
            document.getElementById('orderTotal').textContent = total.toFixed(2);
        }

        function placeOrder() {
            if (selectedMedicines.length === 0) {
                alert('Please add at least one medicine to the order');
                return;
            }

            const order = {
                chemistId: currentChemistId,
                medicines: selectedMedicines,
                notes: document.getElementById('orderNotes').value,
                total: parseFloat(document.getElementById('orderTotal').textContent),
                orderDate: new Date().toISOString()
            };

            // Here you would typically send this order to your backend
            console.log('Placing order:', order);
            alert('Order placed successfully!');
            closeOrderModal();
        }

        function getChemistDetails(chemistId) {
            // This would typically be an API call
            return {
                id: chemistId,
                name: "MedPlus Pharmacy",
                address: "123 Main Street, Sector 15",
                phone: "+91 9876543210"
            };
        }

        // Update the existing sendPrescriptionToChemist function
        function sendPrescriptionToChemist(chemistId) {
            currentChemistId = chemistId;
            viewChemistDetails(chemistId);
        }

        // Add these functions to the existing script section
        let prescriptionMedicines = [];
        let currentPrescriptionChemistId = null;

        function sendPrescriptionToChemist(chemistId) {
            currentPrescriptionChemistId = chemistId;
            const chemist = getChemistDetails(chemistId);
            const modal = document.getElementById('prescriptionModal');
            const chemistInfo = document.getElementById('prescriptionChemistInfo');
            
            chemistInfo.innerHTML = `
                <h3>${chemist.name}</h3>
                <p><strong>Address:</strong> ${chemist.address}</p>
                <p><strong>Phone:</strong> ${chemist.phone}</p>
            `;
            
            modal.classList.add('active');
            resetPrescriptionForm();
        }

        function closePrescriptionModal() {
            document.getElementById('prescriptionModal').classList.remove('active');
            resetPrescriptionForm();
        }

        function resetPrescriptionForm() {
            prescriptionMedicines = [];
            document.getElementById('prescriptionMedicineList').innerHTML = '';
            document.getElementById('patientName').value = '';
            document.getElementById('patientAge').value = '';
            document.getElementById('diagnosis').value = '';
            document.getElementById('prescriptionNotes').value = '';
        }

        function addPrescriptionMedicine() {
            const medicineList = document.getElementById('prescriptionMedicineList');
            const medicineId = Date.now();
            
            const medicineItem = document.createElement('div');
            medicineItem.className = 'prescription-medicine-item';
            medicineItem.setAttribute('data-id', medicineId);
            medicineItem.innerHTML = `
                <select class="medicine-select" required>
                    <option value="">Select Medicine</option>
                    ${Object.keys(medicinePrices).map(med => 
                        `<option value="${med}">${med}</option>`
                    ).join('')}
                </select>
                <input type="text" 
                       placeholder="Dosage" 
                       class="medicine-dosage" 
                       required>
                <input type="text" 
                       placeholder="Duration" 
                       class="medicine-duration" 
                       required>
                <button class="remove-btn" onclick="removePrescriptionMedicine(${medicineId})">Remove</button>
            `;
            
            medicineList.appendChild(medicineItem);
            prescriptionMedicines.push({
                id: medicineId,
                name: '',
                dosage: '',
                duration: ''
            });
        }

        function removePrescriptionMedicine(medicineId) {
            const medicineItem = document.querySelector(`.prescription-medicine-item[data-id="${medicineId}"]`);
            medicineItem.remove();
            prescriptionMedicines = prescriptionMedicines.filter(m => m.id !== medicineId);
        }

        function sendPrescription() {
            const patientName = document.getElementById('patientName').value;
            const patientAge = document.getElementById('patientAge').value;
            const diagnosis = document.getElementById('diagnosis').value;
            const notes = document.getElementById('prescriptionNotes').value;

            if (!patientName || !patientAge || !diagnosis) {
                alert('Please fill in all required fields');
                return;
            }

            // Collect medicine details
            const medicines = Array.from(document.querySelectorAll('.prescription-medicine-item')).map(item => ({
                name: item.querySelector('.medicine-select').value,
                dosage: item.querySelector('.medicine-dosage').value,
                duration: item.querySelector('.medicine-duration').value
            }));

            if (medicines.length === 0) {
                alert('Please add at least one medicine to the prescription');
                return;
            }

            const prescription = {
                chemistId: currentPrescriptionChemistId,
                patient: {
                    name: patientName,
                    age: patientAge
                },
                diagnosis: diagnosis,
                medicines: medicines,
                notes: notes,
                date: new Date().toISOString()
            };

            // Here you would typically send this prescription to your backend
            console.log('Sending prescription:', prescription);
            alert('Prescription sent successfully!');
            closePrescriptionModal();
        }
    </script>
</body>
</html> 